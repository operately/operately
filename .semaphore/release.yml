version: v1.0
name: '${{parameters.RELEASE_TYPE}} Release'
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu2004
blocks:
  - name: Release
    run:
      when: "branch = 'main'"
    task:
      jobs:
        - name: "Release"
          commands:
            - checkout
            - export VERSION=$(bash scripts/calc_next_tag.sh $RELEASE_TYPE)
            - elixir rel/single-host/build.ex $VERSION
